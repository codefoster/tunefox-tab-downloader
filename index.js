import jsdom from 'jsdom';
import fetch from 'node-fetch';
import fs from 'fs';

let { JSDOM } = jsdom;

// pretty manual for now
// these arrays were generated manually
// the cookie below authenticates the pdf download though, so I could use that to fetch the actual songs too

let rootUrl = "https://www.tunefox.com";
let guitarSongs = [
    "/guitar/devils-dream/",
    "/guitar/white-house-blues/",
    "/guitar/paddy-on-the-turnpike/",
    "/guitar/working-on-a-building/",
    "/guitar/rawhide/",
    "/guitar/nobody-loves-me/",
    "/guitar/gold-rush/",
    "/guitar/frosty-the-snowman/",
    "/guitar/jingle-bells/",
    "/guitar/silent-night/",
    "/guitar/santa-claus-is-coming-to-town/",
    "/guitar/i-am-a-pilgrim/",
    "/guitar/salt-creek/",
    "/guitar/shady-grove/",
    "/guitar/black-mountain-rag/",
    "/guitar/lonesome-road-blues/",
    "/guitar/major-scales/",
    "/guitar/c-major-scale-workout/",
    "/guitar/d-major-scale-workout/",
    "/guitar/aint-gonna-work-tomorrow/",
    "/guitar/dig-a-hole-in-the-meadow/",
    "/guitar/dont-let-your-deal-go-down/",
    "/guitar/groundhog/",
    "/guitar/mountain-dew/",
    "/guitar/reuben/",
    "/guitar/roll-in-my-sweet-babys-arms/",
    "/guitar/salty-dog/",
    "/guitar/take-this-hammer/",
    "/guitar/worried-man-blues/",
    "/guitar/little-girl-of-mine-in-tennessee/",
    "/guitar/new-five-cents/",
    "/guitar/new-river-train/",
    "/guitar/crossroad-blues/",
    "/guitar/my-homes-across-the-blue-ridge-mountains/",
    "/guitar/wildwood-flower/",
    "/guitar/tom-dooley/",
    "/guitar/the-old-homeplace/",
    "/guitar/east-virginia-blues/",
    "/guitar/little-maggie/",
    "/guitar/pretty-polly/",
    "/guitar/snowflake-breakdown/",
    "/guitar/cattle-in-the-cane/",
    "/guitar/john-hardy/",
    "/guitar/nine-pound-hammer/",
    "/guitar/red-haired-boy/",
    "/guitar/stoney-point/",
    "/guitar/way-downtown/",
    "/guitar/where-the-soul-of-man-never-dies/",
    "/guitar/long-journey-home/",
    "/guitar/big-sciota/",
    "/guitar/turkey-in-the-straw/",
    "/guitar/careless-love/",
    "/guitar/cherokee-shuffle/",
    "/guitar/cluck-old-hen/",
    "/guitar/cotton-eyed-joe/",
    "/guitar/cripple-creek/",
    "/guitar/cumberland-gap/",
    "/guitar/dark-hollow/",
    "/guitar/eighth-of-january/",
    "/guitar/fire-on-the-mountain/",
    "/guitar/fishers-hornpipe/",
    "/guitar/flop-eared-mule/",
    "/guitar/forked-deer/",
    "/guitar/frosty-morning/",
    "/guitar/grandfathers-clock/",
    "/guitar/hand-me-down-my-walking-cane/",
    "/guitar/home-sweet-home/",
    "/guitar/jesse-james/",
    "/guitar/john-henry/",
    "/guitar/june-apple/",
    "/guitar/liberty/",
    "/guitar/little-rabbit/",
    "/guitar/mississippi-sawyer/",
    "/guitar/oh-susanna/",
    "/guitar/old-joe-clark/",
    "/guitar/ragtime-annie/",
    "/guitar/sally-goodin/",
    "/guitar/soldiers-joy/",
    "/guitar/st-annes-reel/",
    "/guitar/temperance-reel/",
    "/guitar/there-is-a-time/",
    "/guitar/wabash-cannonball/",
    "/guitar/wayfaring-stranger/",
    "/guitar/whiskey-before-breakfast/",
    "/guitar/will-the-circle-be-unbroken/",
    "/guitar/amazing-grace/",
    "/guitar/angeline-the-baker/",
    "/guitar/arkansas-traveler/",
    "/guitar/banks-of-the-ohio/",
    "/guitar/bill-cheatum/",
    "/guitar/billy-in-the-low-ground/",
    "/guitar/buffalo-gals/",
    "/guitar/bury-me-beneath-the-willow/",
    "/guitar/east-tennessee-blues/",
    "/guitar/wreck-of-the-old-97/",
    "/guitar/you-are-my-sunshine/",
    "/guitar/chinquapin-hunting/",
    "/guitar/freight-train/",
    "/guitar/the-old-spinning-wheel/",
    "/guitar/sugarfoot-rag/",
    "/guitar/wild-bill-jones/",
    "/guitar/the-chicken-reel/",
    "/guitar/golden-slippers/",
    "/guitar/alabama-jubilee/",
    "/guitar/daleys-reel/",
    "/guitar/down-yonder/",
    "/guitar/hangmans-reel/",
    "/guitar/lost-indian/",
    "/guitar/beaumont-rag/",
    "/guitar/cuckoos-nest/",
    "/guitar/ill-fly-away/",
    "/guitar/kitchen-girl/",
    "/guitar/leather-britches/",
    "/guitar/power-in-the-blood/",
    "/guitar/redwing/",
    "/guitar/sailors-hornpipe/",
    "/guitar/shove-the-pigs-foot/",
    "/guitar/sitting-on-top-of-the-world/",
    "/guitar/squirrel-hunters/",
    "/guitar/tennessee-waltz/",
    "/guitar/under-the-double-eagle/",
    "/guitar/little-sadie/",
    "/guitar/auld-lang-syne/",
    "/guitar/the-crawdad-song/",
    "/guitar/the-girl-i-left-behind-me/",
    "/guitar/spotted-pony/",
    "/guitar/hunting-the-buffalo/",
    "/guitar/angeline-the-baker-beginner/",
    "/guitar/cluck-old-hen-beginner/",
    "/guitar/cripple-creek-beginner/",
    "/guitar/lonesome-fiddle-blues/",
    "/guitar/crazy-creek/"
];

let banjoSongs = [
    "/banjo/dueling-banjos/",
    "/banjo/frosty-morning/",
    "/banjo/devils-dream/",
    "/banjo/crazy-creek/",
    "/banjo/dark-hollow/",
    "/banjo/nine-pound-hammer/",
    "/banjo/east-tennessee-blues/",
    "/banjo/john-hardy/",
    "/banjo/new-river-train/",
    "/banjo/on-and-on/",
    "/banjo/nobody-loves-me/",
    "/banjo/gold-rush/",
    "/banjo/santa-claus-is-coming-to-town/",
    "/banjo/cripple-creek/",
    "/banjo/home-sweet-home/",
    "/banjo/reuben/",
    "/banjo/cumberland-gap/",
    "/banjo/lonesome-road-blues/",
    "/banjo/john-henry/",
    "/banjo/foggy-mountain-breakdown/",
    "/banjo/fireball-mail/",
    "/banjo/little-darlin-pal-of-mine/",
    "/banjo/i-saw-the-light/",
    "/banjo/sally-ann/",
    "/banjo/groundspeed/",
    "/banjo/pike-county-breakdown/",
    "/banjo/foggy-mountain-special/",
    "/banjo/dear-old-dixie/",
    "/banjo/beginner-banjo-101/",
    "/banjo/melodic-scales/",
    "/banjo/beginner-banjo-102/",
    "/banjo/scruggs-backup-licks/",
    "/banjo/g-melodic-scale-workout/",
    "/banjo/c-melodic-scale-workout/",
    "/banjo/d-melodic-scale-workout/",
    "/banjo/g-single-string-scale-workout/",
    "/banjo/salty-dog-blues/",
    "/banjo/aint-gonna-work-tomorrow/",
    "/banjo/all-the-good-times-are-past-and-gone/",
    "/banjo/hot-corn-cold-corn/",
    "/banjo/down-the-road/",
    "/banjo/dont-let-your-deal-go-down/",
    "/banjo/dig-a-hole-in-the-meadow-darlin-corey/",
    "/banjo/dont-this-road-look-rough-and-rocky/",
    "/banjo/head-over-heels/",
    "/banjo/roll-in-my-sweet-babys-arms/",
    "/banjo/white-house-blues/",
    "/banjo/wreck-of-the-old-97/",
    "/banjo/mountain-dew/",
    "/banjo/blue-ridge-cabin-home/",
    "/banjo/your-love-is-like-a-flower/",
    "/banjo/big-ball-in-brooklyn/",
    "/banjo/old-home-place/",
    "/banjo/cryin-holy/",
    "/banjo/rebecca/",
    "/banjo/sunny-side-of-the-mountain/",
    "/banjo/have-yourself-a-merry-little-christmas/",
    "/banjo/hand-me-down-my-walking-cane/",
    "/banjo/big-spike-hammer/",
    "/banjo/rocky-top/",
    "/banjo/limehouse-blues/",
    "/banjo/auld-lang-syne/",
    "/banjo/oh-susanna/",
    "/banjo/bury-me-beneath-the-willow/",
    "/banjo/ill-fly-away/",
    "/banjo/will-the-circle-be-unbroken/",
    "/banjo/worried-man-blues/",
    "/banjo/wildwood-flower/",
    "/banjo/banjo-in-the-hollow/",
    "/banjo/dooley/",
    "/banjo/east-virginia-blues/",
    "/banjo/man-of-constant-sorrow/",
    "/banjo/handsome-molly/",
    "/banjo/little-maggie/",
    "/banjo/long-journey-home/",
    "/banjo/pretty-polly/",
    "/banjo/clinch-mountain-backstep/",
    "/banjo/pig-in-a-pen/",
    "/banjo/fox-on-the-run/",
    "/banjo/snowflake-breakdown/",
    "/banjo/forked-deer/",
    "/banjo/bill-cheatum/",
    "/banjo/banks-of-the-ohio/",
    "/banjo/blackberry-blossom/",
    "/banjo/arkansas-traveler/",
    "/banjo/angeline-the-baker/",
    "/banjo/amazing-grace/",
    "/banjo/bound-to-ride/",
    "/banjo/turkey-in-the-straw/",
    "/banjo/buffalo-gals/",
    "/banjo/cherokee-shuffle/",
    "/banjo/cotton-eyed-joe/",
    "/banjo/cluck-old-hen/",
    "/banjo/careless-love/",
    "/banjo/groundhog/",
    "/banjo/salt-creek/",
    "/banjo/june-apple/",
    "/banjo/red-haired-boy/",
    "/banjo/jesse-james/",
    "/banjo/you-are-my-sunshine/",
    "/banjo/whiskey-before-breakfast/",
    "/banjo/red-wing/",
    "/banjo/old-joe-clark/",
    "/banjo/wabash-cannonball/",
    "/banjo/leather-britches/",
    "/banjo/billy-in-the-lowground/",
    "/banjo/grandfathers-clock/",
    "/banjo/ragtime-annie/",
    "/banjo/soldiers-joy/",
    "/banjo/shady-grove/",
    "/banjo/raleigh-and-spencer/",
    "/banjo/goodbye-liza-jane/",
    "/banjo/wild-bill-jones/",
    "/banjo/little-sadie/",
    "/banjo/wayfaring-stranger/",
    "/banjo/temperance-reel/",
    "/banjo/chinquapin-hunting/",
    "/banjo/freight-train/",
    "/banjo/the-old-spinning-wheel/",
    "/banjo/sugarfoot-rag/",
    "/banjo/frosty-the-snowman/",
    "/banjo/golden-slippers/",
    "/banjo/jingle-bells/",
    "/banjo/life-is-like-a-mountain-railroad/",
    "/banjo/my-old-kentucky-home/",
    "/banjo/sourwood-mountain/",
    "/banjo/red-river-valley/",
    "/banjo/squirrell-hunters/",
    "/banjo/the-girl-i-left-behind-me/",
    "/banjo/big-sciota/",
    "/banjo/church-in-the-wildwood/",
    "/banjo/cindy/",
    "/banjo/crawdad-song/",
    "/banjo/hunting-the-buffalo/",
    "/banjo/sailors-hornpipe/",
    "/banjo/shortnin-bread/",
    "/banjo/st-annes-reel/",
    "/banjo/the-new-five-cents/",
    "/banjo/cattle-in-the-cane/",
    "/banjo/cuckoos-nest/",
    "/banjo/daleys-reel/",
    "/banjo/down-yonder/",
    "/banjo/fire-on-the-mountain/",
    "/banjo/flod-eared-mule/",
    "/banjo/liberty/",
    "/banjo/spotted-pony/",
    "/banjo/when-the-saints-go-marching-in/",
    "/banjo/down-in-the-willow-garden/",
    "/banjo/fishers-hornpipe/",
    "/banjo/kitchen-girl/",
    "/banjo/angeline-the-baker-beginner/",
    "/banjo/boil-them-cabbage-down-beginner/",
    "/banjo/cripple-creek-beginner/",
    "/banjo/lonesome-fiddle-blues/",
    "/banjo/this-land-is-your-land/",
];

let mandolinSongs = [
    "/mandolin/devils-dream/",
    "/mandolin/banks-of-the-ohio/",
    "/mandolin/bury-me-beneath-the-willow/",
    "/mandolin/white-house-blues/",
    "/mandolin/nine-pound-hammer/",
    "/mandolin/roanoke/",
    "/mandolin/rawhide/",
    "/mandolin/nobody-loves-me/",
    "/mandolin/jingle-bells/",
    "/mandolin/frosty-the-snowman/",
    "/mandolin/black-mountain-rag/",
    "/mandolin/i-am-a-pilgrim/",
    "/mandolin/make-me-a-pallet-of-the-floor/",
    "/mandolin/wabash-cannonball/",
    "/mandolin/g-major-scale-workout/",
    "/mandolin/c-major-scale-workout/",
    "/mandolin/aint-gonna-work-tomorrow/",
    "/mandolin/all-the-good-times-are-past-and-gone/",
    "/mandolin/dig-a-hole-in-the-meadow/",
    "/mandolin/dont-let-your-deal-go-down/",
    "/mandolin/down-the-road/",
    "/mandolin/groundhog/",
    "/mandolin/hot-corn-cold-corn/",
    "/mandolin/long-journey-home/",
    "/mandolin/roll-in-my-sweet-babys-arms/",
    "/mandolin/salty-dog/",
    "/mandolin/take-this-hammer/",
    "/mandolin/new-five-cents/",
    "/mandolin/silent-night/",
    "/mandolin/eight-more-miles-to-louisville/",
    "/mandolin/the-old-homeplace/",
    "/mandolin/new-river-train/",
    "/mandolin/dark-hollow/",
    "/mandolin/auld-lang-syne/",
    "/mandolin/crossroad-blues/",
    "/mandolin/keep-on-the-sunny-side/",
    "/mandolin/wildwood-flower/",
    "/mandolin/ill-fly-away/",
    "/mandolin/there-is-a-time/",
    "/mandolin/tom-dooley/",
    "/mandolin/bound-to-ride/",
    "/mandolin/east-virginia-blues/",
    "/mandolin/little-maggie/",
    "/mandolin/snowflake-breakdown/",
    "/mandolin/gold-rush/",
    "/mandolin/amazing-grace/",
    "/mandolin/angelina-baker/",
    "/mandolin/arkansas-traveler/",
    "/mandolin/big-sciota/",
    "/mandolin/bill-cheatum/",
    "/mandolin/billy-in-the-low-ground/",
    "/mandolin/blackberry-blossom/",
    "/mandolin/boil-them-cabbage-down/",
    "/mandolin/buffalo-gals/",
    "/mandolin/bully-of-the-town/",
    "/mandolin/carelesss-love/",
    "/mandolin/cattle-in-the-cane/",
    "/mandolin/cherokee-shuffle/",
    "/mandolin/cluck-old-hen/",
    "/mandolin/cotton-eyed-joe/",
    "/mandolin/crazy-creek/",
    "/mandolin/cripple-creek/",
    "/mandolin/cumberland-gap/",
    "/mandolin/east-tennessee-blues/",
    "/mandolin/eight-of-january/",
    "/mandolin/fire-on-the-mountain/",
    "/mandolin/fishers-hornpipe/",
    "/mandolin/flop-eared-mule/",
    "/mandolin/forked-deer/",
    "/mandolin/hand-me-down-my-walking-cane/",
    "/mandolin/home-sweet-home/",
    "/mandolin/john-hardy/",
    "/mandolin/leather-britches/",
    "/mandolin/liberty/",
    "/mandolin/mississippi-sawyer/",
    "/mandolin/my-homes-across-the-blue-ridge-mountains/",
    "/mandolin/oh-susanna/",
    "/mandolin/old-joe-clark/",
    "/mandolin/red-haired-boy/",
    "/mandolin/reuben/",
    "/mandolin/sally-goodin/",
    "/mandolin/salt-creek/",
    "/mandolin/shady-grove/",
    "/mandolin/soldiers-joy/",
    "/mandolin/st-annes-reel/",
    "/mandolin/way-downtown/",
    "/mandolin/where-the-soul-never-dies/",
    "/mandolin/worried-man-blues/",
    "/mandolin/you-are-my-sunshine/",
    "/mandolin/will-the-circle-be-unbroken/",
    "/mandolin/chinquapin-hunting/",
    "/mandolin/freight-train/",
    "/mandolin/the-old-spinning-wheel/",
    "/mandolin/sugarfoot-rag/",
    "/mandolin/wild-bill-jones/",
    "/mandolin/the-chicken-reel/",
    "/mandolin/golden-slippers/",
    "/mandolin/alabama-jubilee/",
    "/mandolin/beaumont-rag/",
    "/mandolin/cuckoos-nest/",
    "/mandolin/daleys-reel/",
    "/mandolin/down-yonder/",
    "/mandolin/hangmans-reel/",
    "/mandolin/kentucky-waltz/",
    "/mandolin/kitchen-girl/",
    "/mandolin/lost-indian/",
    "/mandolin/my-old-kentucky-home/",
    "/mandolin/power-in-the-blood/",
    "/mandolin/redwing/",
    "/mandolin/sailors-hornpipe/",
    "/mandolin/shove-the-pigs-foot-further-into-the-fire/",
    "/mandolin/sitting-on-top-of-the-world/",
    "/mandolin/squirrel-hunters/",
    "/mandolin/tennessee-waltz/",
    "/mandolin/under-the-double-eagle/",
    "/mandolin/turkey-in-the-straw/",
    "/mandolin/ragtime-annie/",
    "/mandolin/hunting-the-buffalo/",
    "/mandolin/angeline-the-baker-beginner/",
    "/mandolin/cluck-old-hen-beginner/",
    "/mandolin/cripple-creek-beginner/",
];

//get individual song urls
// let songs = [];
let c = 0;
let fetchSongs = mandolinSongs.map(async url => {
    const dom = new JSDOM(await (await fetch(`${rootUrl}${url}`)).text());
    let songs = Array.from(dom.window.document.querySelectorAll('.btn-detail')).map(e => e.href);

    songs.forEach(async s => {
        let pdfUrl = `${rootUrl}${s}pdf/`;
        const res = await fetch(pdfUrl, {
            headers: {
                "Content-Type": "application/pdf",
                "Cookie": "PHPSESSID=d9132704b089bc162a8c96e11e4069b0; _gcl_au=1.1.2018099581.1594399874; _ga=GA1.2.1530353047.1594399874; __stripe_mid=9eeedd65-14fb-4add-bcd4-d825802a9acf; _iub_cs-57824399=%7B%22consent%22%3Atrue%2C%22timestamp%22%3A%222020-07-10T16%3A51%3A20.980Z%22%2C%22version%22%3A%221.2.4%22%2C%22id%22%3A57824399%7D; highlightAllowed=false; _gid=GA1.2.915281916.1594743073",

            }
        });

        let split = pdfUrl.split('/');
        let filename = `${split[3]}-${split[4]}-${split[5]}`;
        const fileStream = fs.createWriteStream(`${filename}.pdf`);

        await new Promise((resolve, reject) => {
            res.body.pipe(fileStream);
            res.body.on("error", reject);
            fileStream.on("finish", () => {
                console.log(`finished saving ${pdfUrl}`);
                resolve();
            });
        });
    });

});

//let songs = await Promise.all(fetchSongs);
//console.log(songs);

